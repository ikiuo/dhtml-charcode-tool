<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <title>å„ç¨®å‡¦ç†</title>
    <style>
     table {
         border: solid 1px #ccc;
         border-collaspe: collaspe;
         border-spacing: 0;
     }
     th, td {
         border: solid 1px #ccc;
     }
     th {
         background: #eee;
     }
     td {
         padding: 0px;
         margin: 0px;
     }
     .left {
         text-align: left;
     }
     .noborder {
         border-width: 0;
     }
    </style>
  </head>
  <body>

    <table>
      <tr>
        <th>å…¥<br>åŠ›</th>
        <td>
          <textarea cols="80" rows="8" oninput="onInput(this.value)"></textarea>
        </td>
      </tr>
      <tr>
        <th>å½¢<br/>å¼</th>
        <td>
          &nbsp;
          <button onclick="onClick('Normalize')">æ­£è¦åŒ–å½¢å¼</button>
          <button onclick="onClick('CodePoint')">ã‚³ãƒ¼ãƒ‰ ãƒã‚¤ãƒ³ãƒˆ</button>
          <button onclick="onClick('InnerHTML')">innerHTML</button>
          <br/>&nbsp;
          <button onclick="onClick('AlphaNumeric')">è‹±æ•°å­—(ä»–)å¤‰æ›</button>
          <button onclick="onClick('Circled')">å††å†…æ–‡å­—å¤‰æ›</button>
          <button onclick="onClick('Parenthesized')">ä¸¸æ‹¬å¼§æ–‡å­—å¤‰æ›</button>
          <button onclick="onClick('Variation')">ç•°å­—ä½“è¨­å®š</button>
        </td>
      </tr>
    </table>

    <p>å‡ºåŠ›ï¼šé …ç›®ãƒœã‚¿ãƒ³ã®ã‚¯ãƒªãƒƒã‚¯ã§ã€ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã¸çµæœ(ãƒ†ã‚­ã‚¹ãƒˆ)ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚</p>

    <table id="Normalize">
      <tr><th colspan="2">æ­£è¦åŒ–å½¢å¼</th></tr>
      <tr><th>ç¨®é¡</th><th>çµæœ</th></tr>
    </table>
    <table id="CodePoint">
      <tr><th colspan="2">ã‚³ãƒ¼ãƒ‰ ãƒã‚¤ãƒ³ãƒˆ</th></tr>
      <tr><th>ç¨®é¡</th><th>çµæœ</th></tr>
    </table>
    <table id="InnerHTML">
      <tr><th colspan="2">InnerHTML</th></tr>
      <tr><td id="InnerHTML_output"></td></tr>
    </table>

    <table id="AlphaNumeric">
      <tr><th colspan="2">è‹±æ•°å­—(ä»–)ã®å¤‰æ›</th></tr>
      <tr><th>ç¨®é¡</th><th>çµæœ</th></tr>
    </table>
    <table id="Circled">
      <tr><th colspan="2">å††å†…æ–‡å­—ã¸ã®å¤‰æ›</th></tr>
      <tr><th>ç¨®é¡</th><th>çµæœ</th></tr>
    </table>
    <table id="Parenthesized">
      <tr><th colspan="2">ä¸¸æ‹¬å¼§ä»˜ãæ–‡å­—ã¸ã®å¤‰æ›</th></tr>
      <tr><th>ç¨®é¡</th><th>çµæœ</th></tr>
      <tr>
        <th class="left">
          <button onclick="toClipboard(Parenthesized_output.innerText)">
            Parenthesized
          </button>
        </th>
        <td id="Parenthesized_output"></td>
      </tr>
    </table>

    <table id="Variation">
    </table>

    <div>&nbsp;</div>
    <table hidden id="toClipStat" class="noborder">
      <tr><td class="noborder">
        <div>ã‚¯ãƒªãƒƒãƒ— ãƒœãƒ¼ãƒ‰ã¸ã®ã‚³ãƒ”ãƒ¼:</div>
        <blockquote>
          <div id="toClipText" style="background-color: #efefef;"></div>
        </blockquote>
      </td></tr>
    </table>

    <script>

     // ----------------------------------------------------------------------

     const OutputTable = [
         'Normalize', 'CodePoint', 'InnerHTML',
         'AlphaNumeric', 'Circled', 'Parenthesized',
         'Variation',
     ];

     var lastMode = '';
     var lastText = '';

     // ----------------------------------------------------------------------

     function toUTF8(ucs4) {
         return ((ucs4 < 0x00080) ? [ucs4] :
                 (ucs4 < 0x00800) ? [0xc0 | ((ucs4 >> 6) & 0x1f),
                                     0x80 | ((ucs4 >> 0) & 0x3f)] :
                 (ucs4 < 0x10000) ? [0xe0 | ((ucs4 >> 12) & 0x0f),
                                     0x80 | ((ucs4 >>  6) & 0x3f),
                                     0x80 | ((ucs4 >>  0) & 0x3f)] :
                 [0xf0 | ((ucs4 >> 18) & 0x07),
                  0x80 | ((ucs4 >> 12) & 0x3f),
                  0x80 | ((ucs4 >>  6) & 0x3f),
                  0x80 | ((ucs4 >>  0) & 0x3f)]);
     }

     const toDec = (code => code.toString(10));
     const toHex = ((code, prefix) => (prefix ? '0x' : '') + (
         `00000000${code.toString(16).toUpperCase()}`
             .substr(-(((8 + 31 - Math.clz32(code)) >> 3) << 1))));
     const toString = ((code, base, prefix) =>
         ((base == 16) ? toHex(code, prefix) : toDec(code)));

     function encodeHTML(inp) {
         const m = { '<':'&lt;', '&':'&amp;', '>':'&gt;', '\n':'<br/>' };
         return [...inp].map((c) => m[c] ?? c).join('');
     }

     function encodeHTMLN(inp) {
         const m = {
             '<':'&lt;', '&':'&amp;', '>':'&gt;',
             '\n':'<span style="color: red">â†²</span>'
         };
         return [...inp].map((c) => m[c] ?? c).join('');
     }

     // ----------------------------------------------------------------------

     class CodePointRuby {
         static TypeTable = ['UTF-32', 'UTF-16', 'UTF-8'];

         static flagSet = new Set([...Array(0x1f200 - 0x1f1e6)].map((_, n) => n + 0x1f1e6));
         static varselSet = new Set([
             [...Array(0x10)].map((_, n) => n + 0x0ff00),
             [...Array(0xf0)].map((_, n) => n + 0xe0100),
         ].flat());

         constructor(text) {
             const C = CodePointRuby;
             this.C = C;

             const lines = [];
             {
                 let line = '';
                 for (const c of text) {
                     line = line + c;
                     if (c == '\n') {
                         lines.push(line);
                         line = '';
                     }
                 }
                 if (line.length)
                     lines.push(line);
             }

             this.lines = [];
             for (const line of lines) {
                 const chars = [];
                 let lastChar = '';
                 [...line].forEach(c => {
                     const lc = lastChar;
                     lastChar = c;
                     if (C.varselSet.has(c)) {
                         if (chars.length) {
                             chars[chars.length - 1] += c;
                             return;
                         }
                     } else if (C.flagSet.has(c)) {
                         if (C.flagSet.has(lastChar)) {
                             chars[chars.length - 1] += c;
                             lastChar = '';
                             return;
                         }
                     }
                     chars.push(c);
                 });
                 this.lines.push(chars);
             }
         }

         toHTML(mode) {
             const C = this.C;

             const bUTF8  = (mode == 'UTF-8');
             const bUTF16 = (mode == 'UTF-16');
             const bUTF32 = (mode == 'UTF-32');
             const nBase = 16;
             const bPrefix = false;

             let out = '';
             for (const line of this.lines) {
                 out += '<p>';
                 for (const data of line) {
                     let codes;
                     let ruby = `<ruby>${encodeHTMLN(data)}<rp>(</rp>`;
                     if (bUTF32)
                         codes = [...data].map(c => c.codePointAt(0));
                     else if (bUTF16) {
                         codes = [];
                         for (const n in data)
                             codes.push(data.charCodeAt(n));
                     } else if (bUTF8)
                         codes = [...data].map(c => toUTF8(c.codePointAt(0))).flat();
                     ruby += `<rt>[${codes.map(c => toString(c, nBase, bPrefix)).join(',')}]</rt>`;
                     ruby += '<rp>)</rp></ruby>';
                     out += ruby;
                 }
                 out += '</p>';
             }
             return out;
         }

         static toId(name) {
             return `CodePoint_${name.replaceAll(/[-( )]/g, '_')}`;
         }
     }

     // ----------------------------------------------------------------------

     class NormalizeDiff {
         static TypeTable = ['NFC', 'NFD', 'NFKC', 'NFKD'];

         constructor(mode, text) {
             this.mode = mode;
             this.characters = [...text].map(c => {
                 const n  = c.normalize(mode);
                 return { chk:(c == n), inp:c, out:n }
             });

             let pos = 0;
             let end = this.characters.length;
             while (pos < end)
                 pos += this.checkComposite(pos, end);

             this.characters.forEach(c => c.out = encodeHTML(c.out));
         }

         checkComposite(start, end) {
             const mode = this.mode;
             const inp = this.characters;

             let pos = start;
             if (!inp[pos].chk)
                 return 1;

             let s = inp[pos].inp;
             let t = s;
             while (++pos < end) {
                 const c = inp[pos];
                 if (!c.chk)
                     break;
                 s += c.inp;
                 t = s.normalize(mode);
                 if (s == t)
                     continue;
                 const sc = [...s];
                 if (sc.length == 1)
                     continue;
                 const tc = [...t];
                 if (sc.pop() != tc.pop())
                     continue;
                 s = sc.join('');
                 t = tc.join('');
                 break;
             }

             const len = pos - start;
             {
                 const sc = [...s];
                 const tc = [...t];
                 let scnt;
                 for (scnt = 0; scnt < sc.length; scnt++)
                     if (sc[scnt] != tc[scnt])
                         break;
                 start += scnt;
             }
             if (start < pos) {
                 s = '';
                 for (let p = start; p < pos; p++)
                     s += inp[p].inp;
                 t = s.normalize(mode);

                 inp[start].chk = false;
                 inp[start].out = t;
                 while (++start < pos) {
                     inp[start].chk = false;
                     inp[start].out = '';
                 }
             }
             return len;
         }

         toHTML() {
             return this.characters.map(
                 (c) => c.chk ? c.out : !c.out.length ? '' :
                        `<span style="background-color: #fbb">${c.out}</span>`
             ).join('');
         }

         static toId(name) {
             return `Normalize_${name.replaceAll(/[-( )]/g,'_')}`;
         }
     }

     // ----------------------------------------------------------------------

     class ConvertAlphaNumericEx {
         static TypeTable = {
             'SUPERSCRIPT': [
                 'â°','Â¹','Â²','Â³','â´','âµ','â¶','â·','â¸','â¹',
                 'á´¬','á´®','êŸ²','á´°','á´±','êŸ³','á´³','á´´','á´µ','á´¶','á´·','á´¸','á´¹',
                 'á´º','á´¼','á´¾','êŸ´','á´¿','','áµ€','áµ','â±½','áµ‚','','','',
                 'áµƒ','áµ‡','á¶œ','áµˆ','áµ‰','á¶ ','áµ','Ê°','â±','Ê²','áµ','Ë¡','áµ',
                 'â¿','áµ’','áµ–','ğ¥','Ê³','Ë¢','áµ—','áµ˜','áµ›','Ê·','Ë£','Ê¸','á¶»',
                 {
                     '(': 'â½', ')': 'â¾', '-': 'â»', '=': 'â¼', '+': 'âº',

                     'Ã†': 'á´­', 'Ã¦': 'ğƒ', 'Ã°': 'á¶', 'Ã¸': 'ğ¢',
                     'Ä¦': 'êŸ¸', 'Ä§': 'ğ•', 'Å‹': 'áµ‘', 'Å“': 'êŸ¹',
                     'Æ': 'á´²', 'Æ«': 'á¶µ', 'Ç€': 'ğ¶', 'Ç': 'ğ·',
                     'Ç‚': 'ğ¸', 'È¢': 'á´½', 'É': 'áµ„', 'É‘': 'áµ…',
                     'É’': 'á¶›', 'É“': 'ğ…', 'É”': 'áµ“', 'É•': 'á¶',
                     'É–': 'ğ‹', 'É—': 'ğŒ', 'É˜': 'ğ', 'É™': 'áµŠ',
                     'É›': 'áµ‹', 'Éœ': 'áµŒ', 'Éœ': 'á¶Ÿ', 'É': 'ğ',
                     'ÉŸ': 'á¶¡', 'É ': 'ğ“', 'É¡': 'á¶¢', 'É¢': 'ğ’',
                     'É£': 'Ë ', 'É¤': 'ğ‘', 'É¥': 'á¶£', 'É¦': 'Ê±',
                     'É§': 'ğ—', 'É¨': 'á¶¤', 'É©': 'á¶¥', 'Éª': 'á¶¦',
                     'É«': 'ê­', 'É¬': 'ğ›', 'É­': 'á¶©', 'É®': 'ğ',
                     'É¯': 'áµš', 'É°': 'á¶­', 'É±': 'á¶¬', 'É²': 'á¶®',
                     'É³': 'á¶¯', 'É´': 'á¶°', 'Éµ': 'á¶±', 'É¶': 'ğ£',
                     'É·': 'ğ¤', 'É¸': 'á¶²', 'É¹': 'Ê´', 'É»': 'Êµ',
                     'É½': 'ğ¨', 'É¾': 'ğ©', 'Ê€': 'ğª', 'Ê': 'Ê¶',
                     'Ê‚': 'á¶³', 'Êƒ': 'á¶´', 'Ê„': 'ğ˜', 'Êˆ': 'ğ¯',
                     'Ê‰': 'á¶¶', 'ÊŠ': 'á¶·', 'Ê‹': 'á¶¹', 'Ê': 'ê­©',
                     'Ê': 'ğ ', 'Ê': 'ğ²', 'Ê': 'á¶¼', 'Ê‘': 'á¶½',
                     'Ê’': 'á¶¾', 'Ê•': 'Ë¤', 'Ê˜': 'ğµ', 'Ê™': 'ğ„',
                     'Ê›': 'ğ”', 'Êœ': 'ğ–', 'Ê': 'á¶¨', 'ÊŸ': 'á¶«',
                     'Ê¡': 'ğ³', 'Ê¢': 'ğ´', 'Ê£': 'ğ‡', 'Ê¤': 'ğŠ',
                     'Ê¥': 'ğ‰', 'Ê¦': 'ğ¬', 'Ê§': 'ğ®', 'Ê¨': 'ğ«',
                     'Ê©': 'ğ', 'Êª': 'ğ™', 'Ê«': 'ğš', 'Ë': 'ğ',
                     'Ë‘': 'ğ‚', 'Î²': 'áµ', 'Î³': 'áµ', 'Î´': 'áµŸ',
                     'Î¸': 'á¶¿', 'Ï†': 'áµ ', 'Ï‡': 'áµ¡', 'Ğ°': 'ğ€°',
                     'Ğ±': 'ğ€±', 'Ğ²': 'ğ€²', 'Ğ³': 'ğ€³', 'Ğ´': 'ğ€´',
                     'Ğµ': 'ğ€µ', 'Ğ¶': 'ğ€¶', 'Ğ·': 'ğ€·', 'Ğ¸': 'ğ€¸',
                     'Ğº': 'ğ€¹', 'Ğ»': 'ğ€º', 'Ğ¼': 'ğ€»', 'Ğ½': 'áµ¸',
                     'Ğ¾': 'ğ€¼', 'Ğ¿': 'ğ€½', 'Ñ€': 'ğ€¾', 'Ñ': 'ğ€¿',
                     'Ñ‚': 'ğ€', 'Ñƒ': 'ğ', 'Ñ„': 'ğ‚', 'Ñ…': 'ğƒ',
                     'Ñ†': 'ğ„', 'Ñ‡': 'ğ…', 'Ñˆ': 'ğ†', 'ÑŠ': 'êšœ',
                     'Ñ‹': 'ğ‡', 'ÑŒ': 'êš', 'Ñ': 'ğˆ', 'Ñ': 'ğ‰',
                     'Ñ–': 'ğŒ', 'Ñ˜': 'ğ', 'Ò«': 'ğ«', 'Ò¯': 'ğ',
                     'Ò±': 'ğ­', 'Ó': 'ğ', 'Ó™': 'ğ‹', 'Ó©': 'ğ',
                     'áƒœ': 'áƒ¼', 'á´‚': 'áµ†', 'á´–': 'áµ”', 'á´—': 'áµ•',
                     'á´œ': 'á¶¸', 'á´': 'áµ™', 'á´¥': 'áµœ', 'áµ»': 'á¶§',
                     'á¶…': 'á¶ª', 'á¶‘': 'ğ', 'â±±': 'ğ°', 'âµ¡': 'âµ¯',
                     'ê™‘': 'ğ¬', 'êš‰': 'ğŠ', 'êœ§': 'ê­œ', 'ê¯': 'ê°',
                     'ê': 'ğ', 'ê¬·': 'ê­', 'ê­’': 'ê­Ÿ', 'ê­¦': 'ğˆ',
                     'ê­§': 'ğ­', 'ğ¼„': 'ğœ', 'ğ¼…': 'ğŸ', 'ğ¼†': 'ğ¡',
                     'ğ¼ˆ': 'ğ§', 'ğ¼Š': 'ğ¹', 'ğ¼': 'ğº',
                 },
             ],
             'SUBSCRIPT': [
                 'â‚€','â‚','â‚‚','â‚ƒ','â‚„','â‚…','â‚†','â‚‡','â‚ˆ','â‚‰',
                 '','','','','','','','','','','','','',
                 '','','','','','','','','','','','','',
                 'â‚','','','','â‚‘','','','â‚•','áµ¢','â±¼','â‚–','â‚—','â‚˜',
                 'â‚™','â‚’','â‚š','','áµ£','â‚›','â‚œ','áµ¤','áµ¥','','â‚“','','',
                 {
                     '(': 'â‚', ')': 'â‚', '+': 'â‚Š', '-': 'â‚‹', '=': 'â‚Œ',

                     'É™': 'â‚”', 'Î²': 'áµ¦', 'Î³': 'áµ§', 'Ï': 'áµ¨',
                     'Ï†': 'áµ©', 'Ï‡': 'áµª',

                     'Ğ°': 'ğ‘', 'Ğ±': 'ğ’', 'Ğ²': 'ğ“', 'Ğ³': 'ğ”',
                     'Ğ´': 'ğ•', 'Ğµ': 'ğ–', 'Ğ¶': 'ğ—', 'Ğ·': 'ğ˜',
                     'Ğ¸': 'ğ™', 'Ğº': 'ğš', 'Ğ»': 'ğ›', 'Ğ¾': 'ğœ',
                     'Ğ¿': 'ğ', 'Ñ': 'ğ', 'Ñƒ': 'ğŸ', 'Ñ„': 'ğ ',
                     'Ñ…': 'ğ¡', 'Ñ†': 'ğ¢', 'Ñ‡': 'ğ£', 'Ñˆ': 'ğ¤',
                     'ÑŠ': 'ğ¥', 'Ñ‹': 'ğ¦', 'Ñ•': 'ğ©', 'Ñ–': 'ğ¨',
                     'ÑŸ': 'ğª', 'Ò‘': 'ğ§',
                 },
             ],
             'SMALL' : [
                 '','','','','','','','','','',
                 'á´€','Ê™','á´„','á´…','á´‡','êœ°','É¢','Êœ','Éª','á´Š','á´‹','ÊŸ','á´',
                 'É´','á´','á´˜','ê¯','Ê€','êœ±','á´›','á´œ','á´ ','á´¡','','Ê','á´¢',
                 '','','','','','','','','','','','','',
                 '','','','','','','','','','','','','',
                 {
                     'Ã†': 'á´', 'Ã': 'á´†', 'Å': 'á´Œ', 'Å’': 'É¶',
                     'Æ†': 'á´', 'Æ': 'â±»', 'Æ“': 'Ê›', 'Æœ': 'êŸº',
                     'Æ·': 'á´£', 'È¢': 'á´•', 'Î“': 'á´¦', 'Î›': 'á´§',
                     'Î ': 'á´¨', 'Î¡': 'á´©', 'Î¨': 'á´ª', 'Î©': 'ê­¥',
                     'Ğ›': 'á´«', 'áµ·': 'ğ¼‚', 'ê­': 'ğ¼„', 'ê°': 'ğ¼',
                 },
             ],
             /*
                'COMBINING DIACRITICAL MARKS' : [
                '','','','','','','','','','',
                '','','','','','','á·›','','','','','á·','á·Ÿ',
                'á·¡','','','','á·¢','','','','','','','','',
                'Í£','','Í¨','Í©','Í¤','á·¥','','Íª','Í¥','','á·œ','á·','Í«',
                'á· ','Í¦','','','Í¬','á·¤','Í­','Í§','Í®','','Í¯','','á·¦',
                ],
              */
             'FULLWIDTH': [
                 'ï¼','ï¼‘','ï¼’','ï¼“','ï¼”','ï¼•','ï¼–','ï¼—','ï¼˜','ï¼™',
                 'ï¼¡','ï¼¢','ï¼£','ï¼¤','ï¼¥','ï¼¦','ï¼§','ï¼¨','ï¼©','ï¼ª','ï¼«','ï¼¬','ï¼­',
                 'ï¼®','ï¼¯','ï¼°','ï¼±','ï¼²','ï¼³','ï¼´','ï¼µ','ï¼¶','ï¼·','ï¼¸','ï¼¹','ï¼º',
                 'ï½','ï½‚','ï½ƒ','ï½„','ï½…','ï½†','ï½‡','ï½ˆ','ï½‰','ï½Š','ï½‹','ï½Œ','ï½',
                 'ï½','ï½','ï½','ï½‘','ï½’','ï½“','ï½”','ï½•','ï½–','ï½—','ï½˜','ï½™','ï½š',
             ],
             'MATHEMATICAL BOLD': [
                 'ğŸ','ğŸ','ğŸ','ğŸ‘','ğŸ’','ğŸ“','ğŸ”','ğŸ•','ğŸ–','ğŸ—',
                 'ğ€','ğ','ğ‚','ğƒ','ğ„','ğ…','ğ†','ğ‡','ğˆ','ğ‰','ğŠ','ğ‹','ğŒ',
                 'ğ','ğ','ğ','ğ','ğ‘','ğ’','ğ“','ğ”','ğ•','ğ–','ğ—','ğ˜','ğ™',
                 'ğš','ğ›','ğœ','ğ','ğ','ğŸ','ğ ','ğ¡','ğ¢','ğ£','ğ¤','ğ¥','ğ¦',
                 'ğ§','ğ¨','ğ©','ğª','ğ«','ğ¬','ğ­','ğ®','ğ¯','ğ°','ğ±','ğ²','ğ³',
             ],
             'MATHEMATICAL ITALIC': [
                 '','','','','','','','','','',
                 'ğ´','ğµ','ğ¶','ğ·','ğ¸','ğ¹','ğº','ğ»','ğ¼','ğ½','ğ¾','ğ¿','ğ‘€',
                 'ğ‘','ğ‘‚','ğ‘ƒ','ğ‘„','ğ‘…','ğ‘†','ğ‘‡','ğ‘ˆ','ğ‘‰','ğ‘Š','ğ‘‹','ğ‘Œ','ğ‘',
                 'ğ‘','ğ‘','ğ‘','ğ‘‘','ğ‘’','ğ‘“','ğ‘”','â„','ğ‘–','ğ‘—','ğ‘˜','ğ‘™','ğ‘š',
                 'ğ‘›','ğ‘œ','ğ‘','ğ‘','ğ‘Ÿ','ğ‘ ','ğ‘¡','ğ‘¢','ğ‘£','ğ‘¤','ğ‘¥','ğ‘¦','ğ‘§',
             ],
             'MATHEMATICAL BOLD ITALIC': [
                 '','','','','','','','','','',
                 'ğ‘¨','ğ‘©','ğ‘ª','ğ‘«','ğ‘¬','ğ‘­','ğ‘®','ğ‘¯','ğ‘°','ğ‘±','ğ‘²','ğ‘³','ğ‘´',
                 'ğ‘µ','ğ‘¶','ğ‘·','ğ‘¸','ğ‘¹','ğ‘º','ğ‘»','ğ‘¼','ğ‘½','ğ‘¾','ğ‘¿','ğ’€','ğ’',
                 'ğ’‚','ğ’ƒ','ğ’„','ğ’…','ğ’†','ğ’‡','ğ’ˆ','ğ’‰','ğ’Š','ğ’‹','ğ’Œ','ğ’','ğ’',
                 'ğ’','ğ’','ğ’‘','ğ’’','ğ’“','ğ’”','ğ’•','ğ’–','ğ’—','ğ’˜','ğ’™','ğ’š','ğ’›',
             ],
             'MATHEMATICAL SCRIPT': [
                 '','','','','','','','','','',
                 'ğ’œ','â„¬','ğ’','ğ’Ÿ','â„°','â„±','ğ’¢','â„‹','â„','ğ’¥','ğ’¦','â„’','â„³',
                 'ğ’©','ğ’ª','ğ’«','ğ’¬','â„›','ğ’®','ğ’¯','ğ’°','ğ’±','ğ’²','ğ’³','ğ’´','ğ’µ',
                 'ğ’¶','ğ’·','ğ’¸','ğ’¹','â„¯','ğ’»','â„Š','ğ’½','ğ’¾','ğ’¿','ğ“€','ğ“','ğ“‚',
                 'ğ“ƒ','â„´','ğ“…','ğ“†','ğ“‡','ğ“ˆ','ğ“‰','ğ“Š','ğ“‹','ğ“Œ','ğ“','ğ“','ğ“',
             ],
             'MATHEMATICAL SCRIPT (CHANCERY)': [
                 '','','','','','','','','','',
                 'ğ’œï¸€','ğ’ï¸€','ğ’ï¸€','ğ’Ÿï¸€','ğ’ ï¸€','ğ’¡ï¸€','ğ’¢ï¸€','ğ’£ï¸€','ğ’¤ï¸€','ğ’¥ï¸€','ğ’¦ï¸€','ğ’§ï¸€','ğ’¨ï¸€',
                 'ğ’©ï¸€','ğ’ªï¸€','ğ’«ï¸€','ğ’¬ï¸€','ğ’­ï¸€','ğ’®ï¸€','ğ’¯ï¸€','ğ’°ï¸€','ğ’±ï¸€','ğ’²ï¸€','ğ’³ï¸€','ğ’´ï¸€','ğ’µï¸€',
                 'ğ’¶','ğ’·','ğ’¸','ğ’¹','â„¯','ğ’»','â„Š','ğ’½','ğ’¾','ğ’¿','ğ“€','ğ“','ğ“‚',
                 'ğ“ƒ','â„´','ğ“…','ğ“†','ğ“‡','ğ“ˆ','ğ“‰','ğ“Š','ğ“‹','ğ“Œ','ğ“','ğ“','ğ“',
             ],
             'MATHEMATICAL SCRIPT (ROUNDHAND)': [
                 '','','','','','','','','','',
                 'ğ’œï¸','ğ’ï¸','ğ’ï¸','ğ’Ÿï¸','ğ’ ï¸','ğ’¡ï¸','ğ’¢ï¸','ğ’£ï¸','ğ’¤ï¸','ğ’¥ï¸','ğ’¦ï¸','ğ’§ï¸','ğ’¨ï¸',
                 'ğ’©ï¸','ğ’ªï¸','ğ’«ï¸','ğ’¬ï¸','ğ’­ï¸','ğ’®ï¸','ğ’¯ï¸','ğ’°ï¸','ğ’±ï¸','ğ’²ï¸','ğ’³ï¸','ğ’´ï¸','ğ’µï¸',
                 'ğ’¶','ğ’·','ğ’¸','ğ’¹','â„¯','ğ’»','â„Š','ğ’½','ğ’¾','ğ’¿','ğ“€','ğ“','ğ“‚',
                 'ğ“ƒ','â„´','ğ“…','ğ“†','ğ“‡','ğ“ˆ','ğ“‰','ğ“Š','ğ“‹','ğ“Œ','ğ“','ğ“','ğ“',
             ],
             'MATHEMATICAL BOLD SCRIPT': [
                 '','','','','','','','','','',
                 'ğ“','ğ“‘','ğ“’','ğ““','ğ“”','ğ“•','ğ“–','ğ“—','ğ“˜','ğ“™','ğ“š','ğ“›','ğ“œ',
                 'ğ“','ğ“','ğ“Ÿ','ğ“ ','ğ“¡','ğ“¢','ğ“£','ğ“¤','ğ“¥','ğ“¦','ğ“§','ğ“¨','ğ“©',
                 'ğ“ª','ğ“«','ğ“¬','ğ“­','ğ“®','ğ“¯','ğ“°','ğ“±','ğ“²','ğ“³','ğ“´','ğ“µ','ğ“¶',
                 'ğ“·','ğ“¸','ğ“¹','ğ“º','ğ“»','ğ“¼','ğ“½','ğ“¾','ğ“¿','ğ”€','ğ”','ğ”‚','ğ”ƒ',
             ],
             'MATHEMATICAL FRAKTUR': [
                 '','','','','','','','','','',
                 'ğ”„','ğ”…','â„­','ğ”‡','ğ”ˆ','ğ”‰','ğ”Š','â„Œ','â„‘','ğ”','ğ”','ğ”','ğ”',
                 'ğ”‘','ğ”’','ğ”“','ğ””','â„œ','ğ”–','ğ”—','ğ”˜','ğ”™','ğ”š','ğ”›','ğ”œ','â„¨',
                 'ğ”','ğ”Ÿ','ğ” ','ğ”¡','ğ”¢','ğ”£','ğ”¤','ğ”¥','ğ”¦','ğ”§','ğ”¨','ğ”©','ğ”ª',
                 'ğ”«','ğ”¬','ğ”­','ğ”®','ğ”¯','ğ”°','ğ”±','ğ”²','ğ”³','ğ”´','ğ”µ','ğ”¶','ğ”·',
             ],
             'MATHEMATICAL BOLD FRAKTUR': [
                 '','','','','','','','','','',
                 'ğ•¬','ğ•­','ğ•®','ğ•¯','ğ•°','ğ•±','ğ•²','ğ•³','ğ•´','ğ•µ','ğ•¶','ğ•·','ğ•¸',
                 'ğ•¹','ğ•º','ğ•»','ğ•¼','ğ•½','ğ•¾','ğ•¿','ğ–€','ğ–','ğ–‚','ğ–ƒ','ğ–„','ğ–…',
                 'ğ–†','ğ–‡','ğ–ˆ','ğ–‰','ğ–Š','ğ–‹','ğ–Œ','ğ–','ğ–','ğ–','ğ–','ğ–‘','ğ–’',
                 'ğ–“','ğ–”','ğ–•','ğ––','ğ–—','ğ–˜','ğ–™','ğ–š','ğ–›','ğ–œ','ğ–','ğ–','ğ–Ÿ',
             ],
             'MATHEMATICAL DOUBLE STRUCK': [
                 'ğŸ˜','ğŸ™','ğŸš','ğŸ›','ğŸœ','ğŸ','ğŸ','ğŸŸ','ğŸ ','ğŸ¡',
                 'ğ”¸','ğ”¹','â„‚','ğ”»','ğ”¼','ğ”½','ğ”¾','â„','ğ•€','ğ•','ğ•‚','ğ•ƒ','ğ•„',
                 'â„•','ğ•†','â„™','â„š','â„','ğ•Š','ğ•‹','ğ•Œ','ğ•','ğ•','ğ•','ğ•','â„¤',
                 'ğ•’','ğ•“','ğ•”','ğ••','ğ•–','ğ•—','ğ•˜','ğ•™','ğ•š','ğ•›','ğ•œ','ğ•','ğ•',
                 'ğ•Ÿ','ğ• ','ğ•¡','ğ•¢','ğ•£','ğ•¤','ğ•¥','ğ•¦','ğ•§','ğ•¨','ğ•©','ğ•ª','ğ•«',
             ],
             'MATHEMATICAL SANS SERIF': [
                 'ğŸ¢','ğŸ£','ğŸ¤','ğŸ¥','ğŸ¦','ğŸ§','ğŸ¨','ğŸ©','ğŸª','ğŸ«',
                 'ğ– ','ğ–¡','ğ–¢','ğ–£','ğ–¤','ğ–¥','ğ–¦','ğ–§','ğ–¨','ğ–©','ğ–ª','ğ–«','ğ–¬',
                 'ğ–­','ğ–®','ğ–¯','ğ–°','ğ–±','ğ–²','ğ–³','ğ–´','ğ–µ','ğ–¶','ğ–·','ğ–¸','ğ–¹',
                 'ğ–º','ğ–»','ğ–¼','ğ–½','ğ–¾','ğ–¿','ğ—€','ğ—','ğ—‚','ğ—ƒ','ğ—„','ğ—…','ğ—†',
                 'ğ—‡','ğ—ˆ','ğ—‰','ğ—Š','ğ—‹','ğ—Œ','ğ—','ğ—','ğ—','ğ—','ğ—‘','ğ—’','ğ—“',
             ],
             'MATHEMATICAL SANS SERIF BOLD': [
                 'ğŸ¬','ğŸ­','ğŸ®','ğŸ¯','ğŸ°','ğŸ±','ğŸ²','ğŸ³','ğŸ´','ğŸµ',
                 'ğ—”','ğ—•','ğ—–','ğ——','ğ—˜','ğ—™','ğ—š','ğ—›','ğ—œ','ğ—','ğ—','ğ—Ÿ',
                 'ğ— ','ğ—¡','ğ—¢','ğ—£','ğ—¤','ğ—¥','ğ—¦','ğ—§','ğ—¨','ğ—©','ğ—ª','ğ—«','ğ—¬','ğ—­',
                 'ğ—®','ğ—¯','ğ—°','ğ—±','ğ—²','ğ—³','ğ—´','ğ—µ','ğ—¶','ğ—·','ğ—¸','ğ—¹','ğ—º',
                 'ğ—»','ğ—¼','ğ—½','ğ—¾','ğ—¿','ğ˜€','ğ˜','ğ˜‚','ğ˜ƒ','ğ˜„','ğ˜…','ğ˜†','ğ˜‡',
             ],
             'MATHEMATICAL SANS SERIF ITALIC': [
                 '','','','','','','','','','',
                 'ğ˜ˆ','ğ˜‰','ğ˜Š','ğ˜‹','ğ˜Œ','ğ˜','ğ˜','ğ˜','ğ˜','ğ˜‘','ğ˜’','ğ˜“','ğ˜”',
                 'ğ˜•','ğ˜–','ğ˜—','ğ˜˜','ğ˜™','ğ˜š','ğ˜›','ğ˜œ','ğ˜','ğ˜','ğ˜Ÿ','ğ˜ ','ğ˜¡',
                 'ğ˜¢','ğ˜£','ğ˜¤','ğ˜¥','ğ˜¦','ğ˜§','ğ˜¨','ğ˜©','ğ˜ª','ğ˜«','ğ˜¬','ğ˜­','ğ˜®',
                 'ğ˜¯','ğ˜°','ğ˜±','ğ˜²','ğ˜³','ğ˜´','ğ˜µ','ğ˜¶','ğ˜·','ğ˜¸','ğ˜¹','ğ˜º','ğ˜»',
             ],
             'MATHEMATICAL SANS SERIF BOLD ITALIC': [
                 '','','','','','','','','','',
                 'ğ˜¼','ğ˜½','ğ˜¾','ğ˜¿','ğ™€','ğ™','ğ™‚','ğ™ƒ','ğ™„','ğ™…','ğ™†','ğ™‡','ğ™ˆ',
                 'ğ™‰','ğ™Š','ğ™‹','ğ™Œ','ğ™','ğ™','ğ™','ğ™','ğ™‘','ğ™’','ğ™“','ğ™”','ğ™•',
                 'ğ™–','ğ™—','ğ™˜','ğ™™','ğ™š','ğ™›','ğ™œ','ğ™','ğ™','ğ™Ÿ','ğ™ ','ğ™¡','ğ™¢',
                 'ğ™£','ğ™¤','ğ™¥','ğ™¦','ğ™§','ğ™¨','ğ™©','ğ™ª','ğ™«','ğ™¬','ğ™­','ğ™®','ğ™¯',
             ],
             'MATHEMATICAL MONOSPACE': [
                 'ğŸ¶','ğŸ·','ğŸ¸','ğŸ¹','ğŸº','ğŸ»','ğŸ¼','ğŸ½','ğŸ¾','ğŸ¿',
                 'ğ™°','ğ™±','ğ™²','ğ™³','ğ™´','ğ™µ','ğ™¶','ğ™·','ğ™¸','ğ™¹','ğ™º','ğ™»','ğ™¼',
                 'ğ™½','ğ™¾','ğ™¿','ğš€','ğš','ğš‚','ğšƒ','ğš„','ğš…','ğš†','ğš‡','ğšˆ','ğš‰',
                 'ğšŠ','ğš‹','ğšŒ','ğš','ğš','ğš','ğš','ğš‘','ğš’','ğš“','ğš”','ğš•','ğš–',
                 'ğš—','ğš˜','ğš™','ğšš','ğš›','ğšœ','ğš','ğš','ğšŸ','ğš ','ğš¡','ğš¢','ğš£',
             ],
             'CIRCLED': [
                 'â“ª','â€','â','â‚','âƒ','â„','â…','â†','â‡','âˆ',
                 'â’¶','â’·','â’¸','â’¹','â’º','â’»','â’¼','â’½','â’¾','â’¿','â“€','â“','â“‚',
                 'â“ƒ','â“„','â“…','â“†','â“‡','â“ˆ','â“‰','â“Š','â“‹','â“Œ','â“','â“','â“',
                 'â“','â“‘','â“’','â““','â“”','â“•','â“–','â“—','â“˜','â“™','â“š','â“›','â“œ',
                 'â“','â“','â“Ÿ','â“ ','â“¡','â“¢','â“£','â“¤','â“¥','â“¦','â“§','â“¨','â“©',
             ],
             'NEGATIVE CIRCLED': [
                 'â“¿','â¶','â·','â¸','â¹','âº','â»','â¼','â½','â¾',
                 'ğŸ…','ğŸ…‘','ğŸ…’','ğŸ…“','ğŸ…”','ğŸ…•','ğŸ…–','ğŸ…—','ğŸ…˜','ğŸ…™','ğŸ…š','ğŸ…›','ğŸ…œ',
                 'ğŸ…','ğŸ…','ğŸ…Ÿ','ğŸ… ','ğŸ…¡','ğŸ…¢','ğŸ…£','ğŸ…¤','ğŸ…¥','ğŸ…¦','ğŸ…§','ğŸ…¨','ğŸ…©',
                 '','','','','','','','','','','','','',
                 '','','','','','','','','','','','','',
             ],
             'SQUARED': [
                 '','','','','','','','','','',
                 'ğŸ„°','ğŸ„±','ğŸ„²','ğŸ„³','ğŸ„´','ğŸ„µ','ğŸ„¶','ğŸ„·','ğŸ„¸','ğŸ„¹','ğŸ„º','ğŸ„»','ğŸ„¼',
                 'ğŸ„½','ğŸ„¾','ğŸ„¿','ğŸ…€','ğŸ…','ğŸ…‚','ğŸ…ƒ','ğŸ…„','ğŸ……','ğŸ…†','ğŸ…‡','ğŸ…ˆ','ğŸ…‰',
                 '','','','','','','','','','','','','',
                 '','','','','','','','','','','','','',
             ],
             'NEGATIVE SQUARED': [
                 '','','','','','','','','','',
                 'ğŸ…°','ğŸ…±','ğŸ…²','ğŸ…³','ğŸ…´','ğŸ…µ','ğŸ…¶','ğŸ…·','ğŸ…¸','ğŸ…¹','ğŸ…º','ğŸ…»','ğŸ…¼',
                 'ğŸ…½','ğŸ…¾','ğŸ…¿','ğŸ†€','ğŸ†','ğŸ†‚','ğŸ†ƒ','ğŸ†„','ğŸ†…','ğŸ††','ğŸ†‡','ğŸ†ˆ','ğŸ†‰',
                 '','','','','','','','','','','','','',
                 '','','','','','','','','','','','','',
             ],
             'PARENTHESIZED': [
                 '','â‘´','â‘µ','â‘¶','â‘·','â‘¸','â‘¹','â‘º','â‘»','â‘¼',
                 'ğŸ„','ğŸ„‘','ğŸ„’','ğŸ„“','ğŸ„”','ğŸ„•','ğŸ„–','ğŸ„—','ğŸ„˜','ğŸ„™','ğŸ„š','ğŸ„›','ğŸ„œ',
                 'ğŸ„','ğŸ„','ğŸ„Ÿ','ğŸ„ ','ğŸ„¡','ğŸ„¢','ğŸ„£','ğŸ„¤','ğŸ„¥','ğŸ„¦','ğŸ„§','ğŸ„¨','ğŸ„©',
                 'â’œ','â’','â’','â’Ÿ','â’ ','â’¡','â’¢','â’£','â’¤','â’¥','â’¦','â’§','â’¨',
                 'â’©','â’ª','â’«','â’¬','â’­','â’®','â’¯','â’°','â’±','â’²','â’³','â’´','â’µ',
             ],
             'LISU': [
                 '','','','','','','','','','',
                 'ê“®','ê“','ê“š','ê““','ê“°','ê“','ê“–','ê“§','ê“²','ê“™','ê“—','ê“¡','ê“Ÿ',
                 'ê“ ','ê“³','ê“‘','','ê“£','ê“¢','ê“”','ê“´','ê“¦','ê“ª','ê“«','ê“¬','ê“œ',
                 '','','','','','','','','','','','','',
                 '','','','','','','','','','','','','',
             ],
             'TURNED + LISU': [
                 '','','â†Š','â†‹','','','','','','',
                 'ê“¯','ê“­','ê“›','ê“·','ê“±','ê“','ê“¨','ê“§','ê“²','ê“©','ê“˜','ê“¶','ê“ª',
                 'ê“ ','ê“³','ê“’','','ê“¤','ê“¢','ê“•','ê“µ','ê“¥','ê“Ÿ','ê“«','â…„','ê“œ',
                 'É','','É”','','Ç','ÉŸ','áµ·','É¥','á´‰','','Ê','ê','É¯',
                 '','','','','É¹','','Ê‡','','ÊŒ','Ê','','Ê','',
             ],
             'TURNED': [
                 '','','â†Š','â†‹','','','','','','',
                 'â±¯','','Æ†','','Æ','â„²','','ê','','','ê°','ê€','Æœ',
                 '','','','','','','ê±','','É…','','','ğ‘¾°','',
                 'É','','É”','','Ç','ÉŸ','áµ·','É¥','á´‰','','Ê','ê','É¯',
                 '','','','','É¹','','Ê‡','','ÊŒ','Ê','','Ê','',
             ],
         };

         static replace(table, inp) {
             let out = '';
             for (const n in inp) {
                 const c = inp.charCodeAt(n) >>> 0; /*INTåŒ–ã®ãŠå‘ªã„*/
                 let t = '';
                 if (0x30 <= c && c <= 0x39)
                     t = table[c - 0x30];
                 else if (0x41 <= c && c <= 0x5a)
                     t = table[c - 0x41 + 10];
                 else if (0x61 <= c && c <= 0x7a)
                     t = table[c - 0x61 + 36];
                 else if (table.length > 62)
                     t = table[62][inp[n]];
                 out += (t ? t : String.fromCharCode(c));
             }
             return out;
         }

         static convert(mode, text) {
             return ConvertAlphaNumericEx.replace(
                 ConvertAlphaNumericEx.TypeTable[mode],
                 text.normalize('NFKC'));
         }

         static toId(name) {
             return `AlphaNumeric ${name}`.replaceAll(/[-+( )]/g, '_');
         }
     }

     // ----------------------------------------------------------------------

     class ConvertCircled {
         static TypeTable = {
             'CIRCLED': {
                 '0':'â“ª',
                 '1':'â‘ ', '2':'â‘¡', '3':'â‘¢', '4':'â‘£', '5':'â‘¤',
                 '6':'â‘¥', '7':'â‘¦', '8':'â‘§', '9':'â‘¨', '10':'â‘©',
                 '11':'â‘ª', '12':'â‘«', '13':'â‘¬', '14':'â‘­', '15':'â‘®',
                 '16':'â‘¯', '17':'â‘°', '18':'â‘±', '19':'â‘²', '20':'â‘³',
                 '21':'ã‰‘', '22':'ã‰’', '23':'ã‰“', '24':'ã‰”', '25':'ã‰•',
                 '26':'ã‰–', '27':'ã‰—', '28':'ã‰˜', '29':'ã‰™', '30':'ã‰š',
                 '31':'ã‰›', '32':'ã‰œ', '33':'ã‰', '34':'ã‰', '35':'ã‰Ÿ',
                 '36':'ãŠ±', '37':'ãŠ²', '38':'ãŠ³', '39':'ãŠ´', '40':'ãŠµ',
                 '41':'ãŠ¶', '42':'ãŠ·', '43':'ãŠ¸', '44':'ãŠ¹', '45':'ãŠº',
                 '46':'ãŠ»', '47':'ãŠ¼', '48':'ãŠ½', '49':'ãŠ¾', '50':'ãŠ¿',

                 'A':'â’¶', 'B':'â’·', 'C':'â’¸', 'D':'â’¹', 'E':'â’º', 'F':'â’»',
                 'G':'â’¼', 'H':'â’½', 'I':'â’¾', 'J':'â’¿', 'K':'â“€', 'L':'â“',
                 'M':'â“‚', 'N':'â“ƒ', 'O':'â“„', 'P':'â“…', 'Q':'â“†', 'R':'â“‡',
                 'S':'â“ˆ', 'T':'â“‰', 'U':'â“Š', 'V':'â“‹', 'W':'â“Œ', 'X':'â“',
                 'Y':'â“', 'Z':'â“',

                 'a':'â“', 'b':'â“‘', 'c':'â“’', 'd':'â““', 'e':'â“”', 'f':'â“•',
                 'g':'â“–', 'h':'â“—', 'i':'â“˜', 'j':'â“™', 'k':'â“š', 'l':'â“›',
                 'm':'â“œ', 'n':'â“', 'o':'â“', 'p':'â“Ÿ', 'q':'â“ ', 'r':'â“¡',
                 's':'â“¢', 't':'â“£', 'u':'â“¤', 'v':'â“¥', 'w':'â“¦', 'x':'â“§',
                 'y':'â“¨', 'z':'â“©',

                 'CD':'ğŸ„­', 'WZ':'ğŸ„®',

                 'ã‚¢':'ã‹', 'ã‚¤':'ã‹‘', 'ã‚¦':'ã‹’', 'ã‚¨':'ã‹“', 'ã‚ª':'ã‹”',
                 'ã‚«':'ã‹•', 'ã‚­':'ã‹–', 'ã‚¯':'ã‹—', 'ã‚±':'ã‹˜', 'ã‚³':'ã‹™',
                 'ã‚µ':'ã‹š', 'ã‚·':'ã‹›', 'ã‚¹':'ã‹œ', 'ã‚»':'ã‹', 'ã‚½':'ã‹',
                 'ã‚¿':'ã‹Ÿ', 'ãƒ':'ã‹ ', 'ãƒ„':'ã‹¡', 'ãƒ†':'ã‹¢', 'ãƒˆ':'ã‹£',
                 'ãƒŠ':'ã‹¤', 'ãƒ‹':'ã‹¥', 'ãƒŒ':'ã‹¦', 'ãƒ':'ã‹§', 'ãƒ':'ã‹¨',
                 'ãƒ':'ã‹©', 'ãƒ’':'ã‹ª', 'ãƒ•':'ã‹«', 'ãƒ˜':'ã‹¬', 'ãƒ›':'ã‹­',
                 'ãƒ':'ã‹®', 'ãƒŸ':'ã‹¯', 'ãƒ ':'ã‹°', 'ãƒ¡':'ã‹±', 'ãƒ¢':'ã‹²',
                 'ãƒ¤':'ã‹³', 'ãƒ¦':'ã‹´', 'ãƒ¨':'ã‹µ',
                 'ãƒ©':'ã‹¶', 'ãƒª':'ã‹·', 'ãƒ«':'ã‹¸', 'ãƒ¬':'ã‹¹', 'ãƒ­':'ã‹º',
                 'ãƒ¯':'ã‹»', 'ãƒ°':'ã‹¼', 'ãƒ±':'ã‹½', 'ãƒ²':'ã‹¾',

                 'ä¸€':'ãŠ€', 'äºŒ':'ãŠ', 'ä¸‰':'ãŠ‚', 'å››':'ãŠƒ', 'äº”':'ãŠ„',
                 'å…­':'ãŠ…', 'ä¸ƒ':'ãŠ†', 'å…«':'ãŠ‡', 'ä¹':'ãŠˆ', 'å':'ãŠ‰',
                 'æœˆ':'ãŠŠ', 'ç«':'ãŠ‹', 'æ°´':'ãŠŒ', 'æœ¨':'ãŠ', 'é‡‘':'ãŠ', 'åœŸ':'ãŠ',
                 'æ—¥':'ãŠ', 'æ ª':'ãŠ‘', 'æœ‰':'ãŠ’', 'ç¤¾':'ãŠ“', 'å':'ãŠ”', 'ç‰¹':'ãŠ•',
                 'è²¡':'ãŠ–', 'ç¥':'ãŠ—', 'åŠ´':'ãŠ˜', 'ç§˜':'ãŠ™', 'ç”·':'ãŠš', 'å¥³':'ãŠ›',
                 'é©':'ãŠœ', 'å„ª':'ãŠ', 'å°':'ãŠ', 'æ³¨':'ãŠŸ', 'é …':'ãŠ ', 'ä¼‘':'ãŠ¡',
                 'å†™':'ãŠ¢', 'æ­£':'ãŠ£', 'ä¸Š':'ãŠ¤', 'ä¸­':'ãŠ¥', 'ä¸‹':'ãŠ¦', 'å·¦':'ãŠ§',
                 'å³':'ãŠ¨', 'åŒ»':'ãŠ©', 'å®—':'ãŠª', 'å­¦':'ãŠ«', 'ç›£':'ãŠ¬', 'ä¼':'ãŠ­',
                 'è³‡':'ãŠ®', 'å”':'ãŠ¯', 'å¤œ':'ãŠ°', 'å•':'ã‰„', 'å¹¼':'ã‰…', 'æ–‡':'ã‰†',
                 'ç®':'ã‰‡',

                 'á„€':'ã‰ ', 'á„‚':'ã‰¡', 'á„ƒ':'ã‰¢', 'á„…':'ã‰£', 'á„†':'ã‰¤',
                 'á„‡':'ã‰¥', 'á„‰':'ã‰¦', 'á„‹':'ã‰§', 'á„Œ':'ã‰¨', 'á„':'ã‰©',
                 'á„':'ã‰ª', 'á„':'ã‰«', 'á„‘':'ã‰¬', 'á„’':'ã‰­',
                 'ê°€':'ã‰®', 'ë‚˜':'ã‰¯', 'ë‹¤':'ã‰°', 'ë¼':'ã‰±', 'ë§ˆ':'ã‰²', 'ë°”':'ã‰³',
                 'ì‚¬':'ã‰´', 'ì•„':'ã‰µ', 'ì':'ã‰¶', 'ì°¨':'ã‰·', 'ì¹´':'ã‰¸', 'íƒ€':'ã‰¹',
                 'íŒŒ':'ã‰º', 'í•˜':'ã‰»', 'ì°¸ê³ ':'ã‰¼','ì£¼ì˜':'ã‰½','ìš°':'ã‰¾',
             },
             'NEGATIVE CIRCLED': {
                 '0':'â“¿',
                 '1':'â¶', '2':'â·', '3':'â¸', '4':'â¹', '5':'âº',
                 '6':'â»', '7':'â¼', '8':'â½', '9':'â¾', '10':'â¿',
                 '11':'â“«', '12':'â“¬', '13':'â“­', '14':'â“®', '15':'â“¯',
                 '16':'â“°', '17':'â“±', '18':'â“²', '19':'â“³', '20':'â“´',
                 'A':'ğŸ…', 'B':'ğŸ…‘', 'C':'ğŸ…’', 'D':'ğŸ…“', 'E':'ğŸ…”', 'F':'ğŸ…•',
                 'G':'ğŸ…–', 'H':'ğŸ…—', 'I':'ğŸ…˜', 'J':'ğŸ…™', 'K':'ğŸ…š', 'L':'ğŸ…›',
                 'M':'ğŸ…œ', 'N':'ğŸ…', 'O':'ğŸ…', 'P':'ğŸ…Ÿ', 'Q':'ğŸ… ', 'R':'ğŸ…¡',
                 'S':'ğŸ…¢', 'T':'ğŸ…£', 'U':'ğŸ…¤', 'V':'ğŸ…¥', 'W':'ğŸ…¦', 'X':'ğŸ…§',
                 'Y':'ğŸ…¨', 'Z':'ğŸ…©',
             },
             'DINGBAT CIRCLED': {
                 '0':'ğŸ„‹',
                 '1':'â€', '2':'â', '3':'â‚', '4':'âƒ', '5':'â„',
                 '6':'â…', '7':'â†', '8':'â‡', '9':'âˆ', '10':'â‰',
             },
             'DINGBAT NEGATIVE CIRCLED': {
                 '0':'ğŸ„Œ',
                 '1':'âŠ', '2':'â‹', '3':'âŒ', '4':'â', '5':'â',
                 '6':'â', '7':'â', '8':'â‘', '9':'â’', '10':'â“',
             },
             'DINGBAT CIRCLED SANS SERIF': {
                 '1':'â“µ', '2':'â“¶', '3':'â“·', '4':'â“¸', '5':'â“¹',
                 '6':'â“º', '7':'â“»', '8':'â“¼', '9':'â“½', '10':'â“¾',
             },
         }

         static replace(table, text) {
             if (!text)
                 return text;
             const chars = [...text];
             let [last, str] = [chars.length-1, ''];
             for (let i = 0; i < chars.length;) {
                 const [c1, c2] = [chars[i], chars[i+1]];
                 const k = c1 + c2;
                 const v = table[k];
                 if (v) {
                     str += v;
                     i += k.length;
                     continue;
                 } else {
                     str += table[c1] ?? c1;
                     i += c1.length;
                 }
             }
             return str;
         }

         static convert(mode, text) {
             return ConvertCircled.replace(
                 ConvertCircled.TypeTable[mode],
                 text.normalize('NFKC'));
         }

         static toId(name) {
             return `Circled ${name}`.replaceAll(' ', '_');
         }
     }

     // ----------------------------------------------------------------------

     class ConvertParenthesized {
         static Table = {
             "1":"â‘´", "2":"â‘µ", "3":"â‘¶", "4":"â‘·", "5":"â‘¸",
             "6":"â‘¹", "7":"â‘º", "8":"â‘»", "9":"â‘¼", "10":"â‘½",
             "11":"â‘¾", "12":"â‘¿", "13":"â’€", "14":"â’", "15":"â’‚",
             "16":"â’ƒ", "17":"â’„", "18":"â’…", "19":"â’†", "20":"â’‡",

             "A":"ğŸ„", "B":"ğŸ„‘", "C":"ğŸ„’", "D":"ğŸ„“", "E":"ğŸ„”",
             "F":"ğŸ„•", "G":"ğŸ„–", "H":"ğŸ„—", "I":"ğŸ„˜", "J":"ğŸ„™",
             "K":"ğŸ„š", "L":"ğŸ„›", "M":"ğŸ„œ", "N":"ğŸ„", "O":"ğŸ„",
             "P":"ğŸ„Ÿ", "Q":"ğŸ„ ", "R":"ğŸ„¡", "S":"ğŸ„¢", "T":"ğŸ„£",
             "U":"ğŸ„¤", "V":"ğŸ„¥", "W":"ğŸ„¦", "X":"ğŸ„§", "Y":"ğŸ„¨",
             "Z":"ğŸ„©",

             "a":"â’œ", "b":"â’", "c":"â’", "d":"â’Ÿ", "e":"â’ ",
             "f":"â’¡", "g":"â’¢", "h":"â’£", "i":"â’¤", "j":"â’¥",
             "k":"â’¦", "l":"â’§", "m":"â’¨", "n":"â’©", "o":"â’ª",
             "p":"â’«", "q":"â’¬", "r":"â’­", "s":"â’®", "t":"â’¯",
             "u":"â’°", "v":"â’±", "w":"â’²", "x":"â’³", "y":"â’´",
             "z":"â’µ",

             "ä¸€":"ãˆ ", "äºŒ":"ãˆ¡", "ä¸‰":"ãˆ¢", "å››":"ãˆ£", "äº”":"ãˆ¤",
             "å…­":"ãˆ¥", "ä¸ƒ":"ãˆ¦", "å…«":"ãˆ§", "ä¹":"ãˆ¨", "å":"ãˆ©",
             "æœˆ":"ãˆª", "ç«":"ãˆ«", "æ°´":"ãˆ¬", "æœ¨":"ãˆ­", "é‡‘":"ãˆ®",
             "åœŸ":"ãˆ¯", "æ—¥":"ãˆ°",
             "æ ª":"ãˆ±", "æœ‰":"ãˆ²", "ç¤¾":"ãˆ³", "å":"ãˆ´", "ç‰¹":"ãˆµ",
             "è²¡":"ãˆ¶", "ç¥":"ãˆ·", "åŠ´":"ãˆ¸", "ä»£":"ãˆ¹", "å‘¼":"ãˆº",
             "å­¦":"ãˆ»", "ç›£":"ãˆ¼", "ä¼":"ãˆ½", "è³‡":"ãˆ¾", "å”":"ãˆ¿",
             "ç¥­":"ã‰€", "ä¼‘":"ã‰", "è‡ª":"ã‰‚", "è‡³":"ã‰ƒ",

             "á„€":"ãˆ€", "á„‚":"ãˆ", "á„ƒ":"ãˆ‚", "á„…":"ãˆƒ", "á„†":"ãˆ„",
             "á„‡":"ãˆ…", "á„‰":"ãˆ†", "á„‹":"ãˆ‡", "á„Œ":"ãˆˆ", "á„":"ãˆ‰",
             "á„":"ãˆŠ", "á„":"ãˆ‹", "á„‘":"ãˆŒ", "á„’":"ãˆ",
             "ê°€":"ãˆ", "ë‚˜":"ãˆ", "ë‹¤":"ãˆ", "ë¼":"ãˆ‘", "ë§ˆ":"ãˆ’",
             "ë°”":"ãˆ“", "ì‚¬":"ãˆ”", "ì•„":"ãˆ•", "ì":"ãˆ–", "ì°¨":"ãˆ—",
             "ì¹´":"ãˆ˜", "íƒ€":"ãˆ™", "íŒŒ":"ãˆš", "í•˜":"ãˆ›", "ì£¼":"ãˆœ",
             "ì˜¤ì „":"ãˆ", "ì˜¤í›„":"ãˆ",
         }

         static replace(text) {
             return text.replace(/(\([^()]+\))/g, ((_, p) =>
                 ConvertParenthesized.Table[p.slice(1, p.length - 1)] ?? p));
         }
     }

     // ----------------------------------------------------------------------

     class ConvertVariationSelector {
         static variationSelector = [
             [...Array(16)].map((_, n) => [String.fromCodePoint(n + 0xfe00), (n + 0xfe00).toString(16)]),
             [...Array(256-16)].map((_, n) => [String.fromCodePoint(n + 0xe0100), (n + 0xe0100).toString(16)])
         ].flat();

         static replace(text, vsel) {
             return [...text].map(s => {
                 const code = s.codePointAt(0);
                 if ((0xfe00 <= code && code <= 0xfe0f) ||
                     (0x0e0100 <= code && code <= 0x0e01ef))
                     return '';
                 return s + vsel;
             }).join('');
         }

         static toHTML(text) {
             return [
                 '<tr><th colspan="2">ç•°å­—ä½“ã‚³ãƒ¼ãƒ‰è¿½åŠ </th></tr>',
                 '<tr><th>ç¨®é¡</th><th>çµæœ</th></tr>',
                 ConvertVariationSelector.variationSelector.map((vs, i) => [
                     '<tr>',
                     `<th><button onclick="toClipboard(VS_${vs[1]}.innerText)">VS${i+1}</button></th>`,
                     `<td id="VS_${vs[1]}">${encodeHTML(ConvertVariationSelector.replace(text, vs[0]))}</td>`,
                     '</tr>'
                 ].join(''))
             ].flat().join('');
         }
     }

     // ----------------------------------------------------------------------

     function toClipboard(text) {
         navigator.clipboard.writeText(text).then(() => {
             toClipStat.hidden = false;
             toClipText.innerText = text;
             // success
         }, () => {
             // failed
         });
     }

     function onInput(text) {
         lastText = text;

         if (lastMode == 'Normalize') {
             const C = NormalizeDiff;
             C.TypeTable.forEach(name => document.getElementById(C.toId(name)).innerHTML = new C(name, text).toHTML());
             return;
         }
         if (lastMode == 'CodePoint') {
             const C = CodePointRuby;
             const gen = new C(text);
             C.TypeTable.forEach(name => document.getElementById(C.toId(name)).innerHTML = gen.toHTML(name));
             return;
         }
         if (lastMode == 'InnerHTML') {
             InnerHTML_output.innerHTML = text;
             return;
         }

         if (lastMode == 'AlphaNumeric') {
             const C = ConvertAlphaNumericEx;
             Object.keys(C.TypeTable).forEach(name =>
                 document.getElementById(C.toId(name)).innerText = C.convert(name, text));
             return;
         }
         if (lastMode == 'Circled') {
             const C = ConvertCircled;
             Object.keys(C.TypeTable).forEach(name =>
                 document.getElementById(C.toId(name)).innerText = C.convert(name, text));
             return;
         }
         if (lastMode == 'Parenthesized') {
             Parenthesized_output.innerHTML = encodeHTML(ConvertParenthesized.replace(text));
             return;
         }

         if (lastMode == 'Variation') {
             Variation.innerHTML = ConvertVariationSelector.toHTML(text);
             return;
         }
     }

     function onClick(mode) {
         OutputTable.forEach(name =>
             document.getElementById(name).hidden = (name != mode));
         lastMode = mode;
         onInput(lastText);
     }

     window.onload = function() {
         const gentab = ((C, O, tab, button, nfilter) => {
             tab.forEach(name => {
                 const id = C.toId(name);
                 const thn = (!nfilter ? name : nfilter(name)).replaceAll(' ', '&nbsp;');
                 const tht = !button ? thn : `<button onclick="toClipboard(${id}.innerText)">${thn}</button>`;
                 O.insertAdjacentHTML('beforeend', `<tr><th class="left">${tht}</th><td id="${id}"></td></tr>`);
             });
         });

         gentab(CodePointRuby, CodePoint, CodePointRuby.TypeTable);
         gentab(NormalizeDiff, Normalize, NormalizeDiff.TypeTable, true);
         gentab(ConvertAlphaNumericEx, AlphaNumeric,
                Object.keys(ConvertAlphaNumericEx.TypeTable), true,
                n => n.replace('MATHEMATICAL ', 'MATHEMATICAL<br/>'));
         gentab(ConvertCircled, Circled, Object.keys(ConvertCircled.TypeTable), true);

         let output_name = 'AlphaNumeric';
         {
             const url = new URL(window.location);
             const search = url.searchParams;
             const arg_output = {
                 'norm': 'Normalize',
                 'code': 'CodePoint',
                 'inner': 'InnerHTML',
                 'alnum': 'AlphaNumeric',
                 'circle': 'Circled',
                 'paren': 'Parenthesized',
                 'var': 'Variation',
             }[search.get('o')];
             if (arg_output)
                 output_name = arg_output;
         }
         onClick(output_name);
     }

    </script>
  </body>
</html>
